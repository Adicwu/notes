<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
		<style type="text/css">
		</style>
	</head>
	<body>
		<div class="box">
			<pre class="child">
				LazyMan('Tony');
				// Hi I am Tony
				
				LazyMan('Tony').sleep(10).eat('lunch');
				// Hi I am Tony
				// 等待了10秒...
				// I am eating lunch
				
				LazyMan('Tony').eat('lunch').sleep(10).eat('dinner');
				// Hi I am Tony
				// I am eating lunch
				// 等待了10秒...
				// I am eating diner
				
				LazyMan('Tony').eat('lunch').eat('dinner').sleepFirst(5).sleep(10).eat('junk food');
				// Hi I am Tony
				// 等待了5秒...
				// I am eating lunch
				// I am eating dinner
				// 等待了10秒...
				// I am eating junk food
			</pre>
		</div>
	</body>
	<script type="text/javascript">
		class LazyManClass {
			constructor(name) {
				this.taskList = []
				this.name = name
				console.log(`Hi I am ${name}`)
				setTimeout(() => {
					this.next()
				})
			}
			sleep(time) {
				let fn = () => {
					setTimeout(() => {
						console.log(`等待了${time}秒...`)
						this.next()
					}, time * 1000)
				}
				this.taskList.push(fn)
				return this
			}
			sleepFirst(time) {
				let fn = () => {
					setTimeout(() => {
						console.log(`等待了${time}秒...`)
						this.next()
					}, time * 1000)
				}
				this.taskList.unshift(fn)
				return this
			}
			eat(thing) {
				let fn = () => {
					console.log(`I am eating ${thing}`)
					this.next()
				}
				this.taskList.push(fn)
				return this
			}
			next() {
				let fn = this.taskList.shift()
				fn && fn()
			}
		}

		function LazyMan(name) {
			return new LazyManClass(name)
		}
		
		
		LazyMan('Tony');
		LazyMan('Tony').sleep(10).eat('lunch');
		LazyMan('Tony').eat('lunch').sleep(10).eat('dinner');
		LazyMan('Tony').eat('lunch').eat('dinner').sleepFirst(5).sleep(10).eat('junk food');
	</script>
</html>
